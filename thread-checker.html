<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary Meta Tags -->
    <title>Free DMC Inventory Tool | Needle Treasures Nook</title>
    <meta name="title" content="Free DMC Inventory Tool | Needle Treasures Nook">
    <meta name="description" content="Free online DMC thread inventory manager. Track your floss collection, check pattern requirements, find similar colors, and generate shopping lists. Works offline!">
    <meta name="keywords" content="DMC thread checker, floss inventory, cross stitch thread organizer, DMC color chart, thread collection tracker, embroidery floss manager, DMC shopping list, pattern thread checker">
    <meta name="author" content="Marieta - Needle Treasures Nook">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://needletreasuresnook.com/thread-checker.html">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://needletreasuresnook.com/thread-checker.html">
    <meta property="og:title" content="Free DMC Inventory Tool">
    <meta property="og:description" content="Track your DMC thread collection, check pattern requirements, and generate shopping lists. Free tool for cross-stitchers!">
    <meta property="og:image" content="https://needletreasuresnook.com/images/thread-checker-og.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Needle Treasures Nook">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://needletreasuresnook.com/thread-checker.html">
    <meta name="twitter:title" content="Free DMC Inventory Tool">
    <meta name="twitter:description" content="Track your DMC thread collection, check pattern requirements, and generate shopping lists. Free tool for cross-stitchers!">
    <meta name="twitter:image" content="https://needletreasuresnook.com/images/thread-checker-og.jpg">
    
    <!-- Schema.org Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "DMC Inventory Tool",
        "url": "https://needletreasuresnook.com/thread-checker.html",
        "description": "Free online tool to track your DMC thread collection, check pattern requirements, find similar colors, and generate shopping lists.",
        "applicationCategory": "UtilitiesApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "author": {
            "@type": "Organization",
            "name": "Needle Treasures Nook",
            "url": "https://needletreasuresnook.com"
        },
        "featureList": [
            "Track DMC thread inventory",
            "Check pattern thread requirements",
            "Find similar DMC colors",
            "Generate shopping lists",
            "Export to PDF",
            "Works offline"
        ]
    }
    </script>
    
    <!-- FAQ Schema for better search results -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "How do I track my DMC thread collection?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Click on any thread color to add it to your collection. Use the + and - buttons to adjust quantities. Your data is saved automatically in your browser."
                }
            },
            {
                "@type": "Question",
                "name": "Can I check what threads I need for a pattern?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes! Paste your pattern's thread list in the Pattern Checker tab. The tool will show which threads you have and which you need to buy."
                }
            },
            {
                "@type": "Question",
                "name": "Does the DMC Inventory Tool work offline?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes! Once loaded, the tool works offline. Your thread collection data is stored locally on your device."
                }
            }
        ]
    }
    </script>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="icon-96x96.png">
    <link rel="apple-touch-icon" href="icon-192x192.png">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#C67B5C">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600;700&family=Lato:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --terracotta: #C67B5C;
            --terracotta-dark: #A85D40;
            --cream: #F5F0E8;
            --cream-dark: #EDE6DA;
            --sage: #8B9D83;
            --sage-dark: #6F8066;
            --brown: #6B5345;
            --taupe: #B8A99A;
            --white: #FDFCFA;
            --text-dark: #3D3028;
            --text-medium: #5C4D42;
            --text-light: #7A6B5E;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Lato', sans-serif;
            background: var(--cream);
            color: var(--text-dark);
            line-height: 1.5;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--terracotta) 0%, var(--terracotta-dark) 100%);
            color: white;
            padding: 0.5rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .home-link {
            font-size: 1.3rem;
            text-decoration: none;
            margin-right: 0.75rem;
            opacity: 0.9;
            transition: opacity 0.2s;
        }
        .home-link:hover {
            opacity: 1;
        }

        .install-btn {
            background: white;
            color: var(--terracotta);
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .install-btn:hover {
            background: var(--cream);
            transform: scale(1.05);
        }

        /* Install Modal */
        .install-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .install-modal-content {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            max-width: 400px;
            width: 90%;
            position: relative;
            text-align: center;
        }
        .install-modal h2 {
            color: var(--terracotta);
            margin-bottom: 0.5rem;
        }
        .install-modal p {
            color: var(--text-medium);
            margin-bottom: 1.5rem;
        }
        .install-instructions {
            text-align: left;
            background: var(--cream);
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
        }
        .instruction-group {
            margin-bottom: 1rem;
        }
        .instruction-group:last-child {
            margin-bottom: 0;
        }
        .instruction-group h3 {
            font-size: 0.9rem;
            color: var(--brown);
            margin-bottom: 0.25rem;
        }
        .instruction-group p {
            font-size: 0.85rem;
            margin: 0;
        }
        .close-modal {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
        }
        .got-it-btn {
            background: var(--terracotta);
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
        }
        .got-it-btn:hover {
            background: var(--terracotta-dark);
        }

        .header-center {
            display: flex;
            gap: 1.25rem;
            font-size: 0.75rem;
        }

        .header-center span { font-weight: 600; }

        .instagram-link {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            color: white;
            text-decoration: none;
            font-size: 0.7rem;
            opacity: 0.9;
        }
        .instagram-link:hover { opacity: 1; }
        .instagram-link svg { width: 14px; height: 14px; }

        /* Layout */
        .main-container {
            display: flex;
            height: calc(100vh - 38px);
        }

        /* Left Panel */
        .collection-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--white);
        }

        .toolbar {
            padding: 0.5rem 0.75rem;
            border-bottom: 1px solid var(--cream-dark);
            display: flex;
            gap: 0.4rem;
            align-items: center;
            background: var(--cream);
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 150px;
            max-width: 220px;
            padding: 0.4rem 0.65rem;
            border: 1px solid var(--cream-dark);
            border-radius: 5px;
            font-size: 0.8rem;
            background: white;
        }
        .search-input:focus {
            outline: none;
            border-color: var(--terracotta);
        }

        .filter-btn {
            padding: 0.35rem 0.65rem;
            border: none;
            background: white;
            border-radius: 5px;
            font-size: 0.7rem;
            cursor: pointer;
            color: var(--text-medium);
            transition: all 0.15s;
        }
        .filter-btn:hover { background: var(--cream-dark); }
        .filter-btn.active {
            background: var(--terracotta);
            color: white;
        }

        .thread-grid {
            flex: 1;
            overflow-y: auto;
            padding: 0.4rem;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 0.3rem;
            align-content: start;
        }

        .thread-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.35rem 0.6rem;
            background: var(--cream);
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.15s;
        }
        .thread-item:hover { background: var(--cream-dark); }
        .thread-item.checked {
            background: var(--sage);
            color: white;
        }

        .thread-checkbox {
            width: 18px;
            height: 18px;
            border: 2px solid var(--taupe);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            background: white;
        }
        .thread-item.checked .thread-checkbox {
            background: white;
            border-color: white;
        }
        .thread-checkbox svg {
            width: 12px;
            height: 12px;
            display: none;
        }
        .thread-item.checked .thread-checkbox svg {
            display: block;
            color: var(--sage);
        }

        .color-swatch {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            border: 1px solid rgba(0,0,0,0.15);
            flex-shrink: 0;
        }

        .thread-item.checked .color-swatch {
            border-color: rgba(255,255,255,0.4);
        }

        .thread-number {
            font-weight: 700;
            min-width: 45px;
        }

        .thread-name {
            flex: 1;
            opacity: 0.85;
            font-size: 0.75rem;
        }

        .qty-badge {
            background: rgba(255,255,255,0.4);
            padding: 0.15rem 0.5rem;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
            min-width: 28px;
            text-align: center;
        }
        .thread-item:not(.checked) .qty-badge {
            background: var(--cream-dark);
            color: var(--text-light);
        }
        .thread-item.checked .qty-badge {
            background: rgba(255,255,255,0.3);
        }

        .qty-controls {
            display: flex;
            align-items: center;
            gap: 0.2rem;
        }

        .qty-btn {
            width: 22px;
            height: 22px;
            border: none;
            background: rgba(255,255,255,0.5);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-medium);
        }
        .thread-item.checked .qty-btn {
            background: rgba(255,255,255,0.25);
            color: white;
        }
        .qty-btn:hover {
            background: rgba(255,255,255,0.7);
        }

        /* Right Panel */
        .pattern-panel {
            width: 340px;
            display: flex;
            flex-direction: column;
            background: var(--white);
            border-left: 1px solid var(--cream-dark);
        }

        .panel-tabs {
            display: flex;
            border-bottom: 1px solid var(--cream-dark);
        }

        .panel-tab {
            flex: 1;
            padding: 0.6rem;
            border: none;
            background: var(--cream);
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            color: var(--text-medium);
            transition: all 0.15s;
        }
        .panel-tab:hover { background: var(--cream-dark); }
        .panel-tab.active {
            background: var(--white);
            color: var(--terracotta);
            border-bottom: 2px solid var(--terracotta);
        }

        .tab-content {
            display: none;
            flex-direction: column;
            flex: 1;
            overflow: hidden;
        }
        .tab-content.active {
            display: flex;
        }

        .input-area {
            padding: 0.65rem;
            border-bottom: 1px solid var(--cream-dark);
        }

        .input-area label {
            display: block;
            font-size: 0.7rem;
            color: var(--text-light);
            margin-bottom: 0.3rem;
        }

        .pattern-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--cream-dark);
            border-radius: 5px;
            font-size: 0.85rem;
            font-family: inherit;
            resize: none;
            height: 60px;
        }
        .pattern-input:focus {
            outline: none;
            border-color: var(--terracotta);
        }

        .color-search-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--cream-dark);
            border-radius: 5px;
            font-size: 0.85rem;
        }
        .color-search-input:focus {
            outline: none;
            border-color: var(--terracotta);
        }

        .results-area {
            flex: 1;
            overflow-y: auto;
            padding: 0.65rem;
        }

        .result-group {
            margin-bottom: 0.85rem;
        }

        .result-title {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-medium);
            margin-bottom: 0.4rem;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        .dot.green { background: var(--sage); }
        .dot.orange { background: var(--terracotta); }
        .dot.blue { background: #5B8DB8; }

        .thread-list {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }

        .thread-row {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 0.6rem;
            border-radius: 5px;
            font-size: 0.8rem;
        }
        .thread-row.owned {
            background: rgba(139, 157, 131, 0.15);
        }
        .thread-row.needed {
            background: rgba(198, 123, 92, 0.15);
        }
        .thread-row .mini-swatch {
            width: 16px;
            height: 16px;
            border-radius: 3px;
            border: 1px solid rgba(0,0,0,0.1);
            flex-shrink: 0;
        }
        .thread-row .number {
            font-weight: 700;
            min-width: 45px;
        }
        .thread-row .name {
            flex: 1;
            color: var(--text-medium);
            font-size: 0.75rem;
        }

        .empty-state {
            text-align: center;
            padding: 1.5rem;
            color: var(--taupe);
            font-size: 0.85rem;
            line-height: 1.6;
        }

        /* Similar Color Result */
        .similar-result {
            background: var(--cream);
            border-radius: 6px;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
        }

        .similar-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.6rem;
        }

        .similar-header .swatch {
            width: 30px;
            height: 30px;
            border-radius: 4px;
            border: 1px solid rgba(0,0,0,0.15);
        }

        .similar-header .info {
            flex: 1;
        }

        .similar-header .number {
            font-weight: 700;
            font-size: 0.95rem;
        }

        .similar-header .name {
            font-size: 0.7rem;
            color: var(--text-light);
        }

        .similar-header .status {
            font-size: 0.65rem;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            font-weight: 600;
        }

        .similar-header .status.owned {
            background: var(--sage);
            color: white;
        }

        .similar-header .status.not-owned {
            background: var(--taupe);
            color: white;
        }

        .similar-list-title {
            font-size: 0.7rem;
            color: var(--text-light);
            margin-bottom: 0.4rem;
        }

        .similar-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.3rem;
        }

        .similar-tag {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            background: rgba(91, 141, 184, 0.12);
            color: #3D6B8C;
            cursor: pointer;
        }
        .similar-tag:hover {
            background: rgba(91, 141, 184, 0.22);
        }
        .similar-tag .mini-swatch {
            width: 14px;
            height: 14px;
            border-radius: 2px;
            border: 1px solid rgba(0,0,0,0.1);
        }
        .similar-tag.has-it {
            background: rgba(139, 157, 131, 0.2);
            color: var(--sage-dark);
        }

        .actions {
            padding: 0.6rem;
            border-top: 1px solid var(--cream-dark);
            display: flex;
            gap: 0.4rem;
        }

        .btn {
            flex: 1;
            padding: 0.55rem;
            border: none;
            border-radius: 5px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.3rem;
            transition: all 0.15s;
        }
        .btn svg { width: 15px; height: 15px; }
        .btn-primary {
            background: var(--terracotta);
            color: white;
        }
        .btn-primary:hover { background: var(--terracotta-dark); }
        .btn-secondary {
            background: var(--cream);
            color: var(--text-medium);
        }
        .btn-secondary:hover { background: var(--cream-dark); }

        /* Promo Banner & Email Signup */
        .promo-banner {
            padding: 0.75rem;
            background: linear-gradient(135deg, var(--cream) 0%, var(--cream-dark) 100%);
            border-top: 1px solid var(--cream-dark);
        }

        .email-signup {
            text-align: center;
            margin-bottom: 0.5rem;
        }

        .signup-title {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-medium);
            margin-bottom: 0.5rem;
        }

        .signup-form {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
        }

        .signup-form .form-row {
            display: flex;
            gap: 0.3rem;
        }

        .signup-form input[type="email"] {
            flex: 1;
            padding: 0.45rem 0.6rem;
            border: 1px solid var(--cream-dark);
            border-radius: 5px;
            font-size: 0.8rem;
            background: white;
        }
        .signup-form input[type="email"]:focus {
            outline: none;
            border-color: var(--terracotta);
        }

        .signup-form button {
            padding: 0.45rem 0.8rem;
            background: var(--terracotta);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.15s;
        }
        .signup-form button:hover {
            background: var(--terracotta-dark);
        }

        .gdpr-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 0.4rem;
            text-align: left;
            cursor: pointer;
        }

        .gdpr-checkbox input[type="checkbox"] {
            margin-top: 2px;
            width: 14px;
            height: 14px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .gdpr-checkbox span {
            font-size: 0.6rem;
            color: var(--text-light);
            line-height: 1.3;
        }

        .gdpr-checkbox a {
            color: var(--terracotta);
            text-decoration: underline;
        }

        .signup-note {
            font-size: 0.6rem;
            color: var(--text-light);
            margin-top: 0.25rem;
        }

        .shop-link {
            display: block;
            text-align: center;
            font-size: 0.7rem;
            color: var(--terracotta);
            font-weight: 600;
            text-decoration: none;
            padding-top: 0.4rem;
            border-top: 1px solid rgba(0,0,0,0.05);
            margin-top: 0.5rem;
        }
        .shop-link:hover {
            text-decoration: underline;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--brown);
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 6px;
            font-size: 0.85rem;
            opacity: 0;
            transition: all 0.3s;
            z-index: 1000;
        }
        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        /* Print Styles */
        @media print {
            body { background: white !important; }
            .header, .collection-panel, .panel-tabs, .promo-banner, .actions, .input-area { 
                display: none !important; 
            }
            .main-container { display: block !important; height: auto !important; }
            .pattern-panel { 
                width: 100% !important; 
                border: none !important; 
                box-shadow: none !important;
            }
            .tab-content { display: flex !important; }
            .results-area { 
                overflow: visible !important; 
                padding: 0 !important;
            }
        }

        /* Mobile */
        @media (max-width: 768px) {
            .main-container { flex-direction: column; }
            .pattern-panel { 
                width: 100%; 
                height: 50vh;
                border-left: none;
                border-top: 2px solid var(--cream-dark);
            }
            .collection-panel { height: 50vh; }
            .thread-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
        }

        /* Print Preview Modal */
        .print-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .print-modal.show {
            display: flex;
        }
        .print-content {
            background: white;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .print-header {
            background: linear-gradient(135deg, var(--terracotta) 0%, var(--terracotta-dark) 100%);
            color: white;
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .print-header h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.3rem;
        }
        .print-header .date {
            font-size: 0.8rem;
            opacity: 0.9;
        }
        .print-body {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
        }
        .print-section {
            margin-bottom: 1.5rem;
        }
        .print-section-title {
            font-size: 0.9rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--cream);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .print-section-title.needed { color: var(--terracotta); }
        .print-section-title.owned { color: var(--sage-dark); }
        .print-thread {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--cream);
        }
        .print-thread .swatch {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            border: 1px solid rgba(0,0,0,0.15);
            flex-shrink: 0;
        }
        .print-thread .number {
            font-weight: 700;
            min-width: 50px;
        }
        .print-thread .name {
            flex: 1;
            color: var(--text-medium);
        }
        .print-thread .qty-input {
            width: 50px;
            padding: 0.3rem;
            border: 1px solid var(--cream-dark);
            border-radius: 4px;
            text-align: center;
            font-size: 0.85rem;
        }
        .print-thread .qty-label {
            font-size: 0.75rem;
            color: var(--text-light);
        }
        .print-footer {
            padding: 1rem 1.5rem;
            background: var(--cream);
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
        }
        .print-footer .btn {
            flex: none;
            padding: 0.6rem 1.5rem;
        }
        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0.8;
        }
        .close-btn:hover { opacity: 1; }
    </style>
</head>
<body>
    <header class="header">
        <a href="index.html" class="home-link" title="Back to Home">üè†</a>
        <h1>üßµ DMC Inventory Tool</h1>
        <div class="header-center">
            <div>Owned: <span id="ownedCount">0</span></div>
            <div>Skeins: <span id="skeinCount">0</span></div>
        </div>
        <button id="installBtn" class="install-btn" title="Add to Home Screen for offline use">üì≤ Install App</button>
        <a href="https://www.instagram.com/needletreasuresnook" target="_blank" class="instagram-link">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
            </svg>
            @needletreasuresnook
        </a>
    </header>

    <!-- Install Instructions Modal -->
    <div id="installModal" class="install-modal" style="display:none;">
        <div class="install-modal-content">
            <button class="close-modal" onclick="closeInstallModal()">√ó</button>
            <h2>üì≤ Install DMC Inventory Tool</h2>
            <p>Add this app to your home screen for quick access and offline use!</p>
            <div class="install-instructions">
                <div class="instruction-group">
                    <h3>üì± iPhone/iPad:</h3>
                    <p>Tap <strong>Share</strong> ‚Üí <strong>Add to Home Screen</strong></p>
                </div>
                <div class="instruction-group">
                    <h3>ü§ñ Android:</h3>
                    <p>Tap <strong>‚ãÆ Menu</strong> ‚Üí <strong>Add to Home Screen</strong></p>
                </div>
                <div class="instruction-group">
                    <h3>üíª Desktop Chrome:</h3>
                    <p>Click <strong>‚ãÆ Menu</strong> ‚Üí <strong>Install DMC Inventory Tool</strong></p>
                </div>
            </div>
            <button class="got-it-btn" onclick="closeInstallModal()">Got it!</button>
        </div>
    </div>

    <div class="main-container">
        <div class="collection-panel">
            <div class="toolbar">
                <input type="text" class="search-input" id="searchInput" placeholder="Search threads...">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="owned">Owned</button>
                <button class="filter-btn" data-filter="needed">Need</button>
            </div>
            <div class="thread-grid" id="threadGrid"></div>
        </div>

        <div class="pattern-panel">
            <div class="panel-tabs">
                <button class="panel-tab active" data-tab="checker">üõí Pattern Checker</button>
                <button class="panel-tab" data-tab="similar">üé® Find Similar</button>
            </div>

            <!-- Pattern Checker Tab -->
            <div class="tab-content active" id="checkerTab">
                <div class="input-area">
                    <label>Paste thread numbers from your pattern:</label>
                    <textarea class="pattern-input" id="patternInput" placeholder="310, 321, 3801, blanc, ecru..."></textarea>
                </div>
                <div class="results-area" id="resultsArea">
                    <div class="empty-state">
                        Enter thread numbers to see<br>what you have vs. need to buy
                    </div>
                </div>
                <div class="actions">
                    <button class="btn btn-secondary" onclick="copyList()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2"></rect>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                        </svg>
                        Copy
                    </button>
                    <button class="btn btn-primary" onclick="openPrintModal()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6,9 6,2 18,2 18,9"></polyline>
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                            <rect x="6" y="14" width="12" height="8"></rect>
                        </svg>
                        Print / PDF
                    </button>
                </div>
            </div>

            <!-- Find Similar Tab -->
            <div class="tab-content" id="similarTab">
                <div class="input-area">
                    <label>Enter a DMC number to find similar colors:</label>
                    <input type="text" class="color-search-input" id="colorSearchInput" placeholder="e.g. 310, 321, 3801...">
                </div>
                <div class="results-area" id="similarResults">
                    <div class="empty-state">
                        Ran out of a thread?<br>Find the closest alternatives!
                    </div>
                </div>
            </div>

            <div class="promo-banner">
                <div class="email-signup" id="emailSignup">
                    <p class="signup-title">üìß Get free patterns & stitching tips!</p>
                    <form class="signup-form" action="https://assets.mailerlite.com/jsonp/2010016/forms/175294884076324104/subscribe" method="post" target="_blank">
                        <div class="form-row">
                            <input type="email" name="fields[email]" placeholder="Your email" required>
                            <button type="submit">Join</button>
                        </div>
                        <label class="gdpr-checkbox">
                            <input type="checkbox" name="gdpr_consent" required>
                            <span>I agree to receive emails and accept the <a href="https://needletreasuresnook.etsy.com/policy/privacy" target="_blank">Privacy Policy</a></span>
                        </label>
                        <input type="hidden" name="ml-submit" value="1">
                        <input type="hidden" name="anticsrf" value="true">
                    </form>
                    <p class="signup-note">No spam ‚Ä¢ Unsubscribe anytime</p>
                </div>
                <a href="https://needletreasuresnook.etsy.com" target="_blank" class="shop-link">Visit my Etsy shop ‚Üí</a>
            </div>
        </div>
    </div>

    <!-- Print Modal -->
    <div class="print-modal" id="printModal">
        <div class="print-content">
            <div class="print-header">
                <div>
                    <h2>üßµ Shopping List</h2>
                    <div class="date" id="printDate"></div>
                </div>
                <button class="close-btn" onclick="closePrintModal()">√ó</button>
            </div>
            <div class="print-body" id="printBody">
                <!-- Content generated by JS -->
            </div>
            <div class="print-footer">
                <button class="btn btn-secondary" onclick="closePrintModal()">Cancel</button>
                <button class="btn btn-primary" onclick="doPrint()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6,9 6,2 18,2 18,9"></polyline>
                        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                        <rect x="6" y="14" width="12" height="8"></rect>
                    </svg>
                    Print / Save PDF
                </button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // DMC Thread Database with HEX colors
        const DMC_THREADS = [
            ["BLANC", "White", "#FFFFFF"],
            ["ECRU", "Ecru", "#F0EAD6"],
            ["B5200", "Snow White", "#FFFFFF"],
            ["150", "Dusty Rose Vy Dk", "#AB4D6C"],
            ["151", "Dusty Rose Vy Lt", "#F0CED4"],
            ["152", "Shell Pink Med Lt", "#E2A099"],
            ["153", "Violet Very Light", "#E6CEE3"],
            ["154", "Grape Very Dark", "#572433"],
            ["155", "Blue Violet Med Dk", "#9891BA"],
            ["156", "Blue Violet Med Lt", "#A3A4CE"],
            ["157", "Cornflower Bl Vy Lt", "#BBC3D9"],
            ["158", "Cornflower Med Vy Dk", "#4C526E"],
            ["159", "Blue Gray Light", "#C7CBD9"],
            ["160", "Blue Gray Medium", "#999FB5"],
            ["161", "Blue Gray", "#7780A0"],
            ["162", "Blue Ultra Vy Lt", "#DBECF6"],
            ["163", "Celadon Green Med", "#4D997A"],
            ["164", "Forest Green Lt", "#C8D9B3"],
            ["165", "Moss Green Vy Lt", "#EFF3C2"],
            ["166", "Moss Green Med Lt", "#C0C840"],
            ["167", "Yellow Beige Vy Dk", "#A77B40"],
            ["168", "Pewter Very Light", "#D1D1D1"],
            ["169", "Pewter Light", "#848484"],
            ["208", "Lavender Vy Dk", "#835B94"],
            ["209", "Lavender Dark", "#A47FB3"],
            ["210", "Lavender Medium", "#C3A0C9"],
            ["211", "Lavender Light", "#E3D0E6"],
            ["221", "Shell Pink Vy Dk", "#883E43"],
            ["223", "Shell Pink Light", "#CC8484"],
            ["224", "Shell Pink Vy Lt", "#EBB9B5"],
            ["225", "Shell Pink Ult Vy Lt", "#FFE8E3"],
            ["300", "Mahogany Vy Dk", "#6F2B1C"],
            ["301", "Mahogany Medium", "#B35C39"],
            ["304", "Christmas Red Med", "#B72327"],
            ["307", "Lemon", "#FDEE4D"],
            ["309", "Rose Dark", "#BA4364"],
            ["310", "Black", "#000000"],
            ["311", "Navy Blue Med", "#1C4566"],
            ["312", "Navy Blue Light", "#2E5B82"],
            ["315", "Antique Mauve Vy Dk", "#814953"],
            ["316", "Antique Mauve Med", "#B87A82"],
            ["317", "Pewter Gray", "#6C6C6C"],
            ["318", "Steel Gray Light", "#A6A6A6"],
            ["319", "Pistachio Grn Vy Dk", "#205D3B"],
            ["320", "Pistachio Green Med", "#6B9362"],
            ["321", "Christmas Red", "#C72B35"],
            ["322", "Navy Blue Vy Lt", "#5B8CBE"],
            ["326", "Rose Very Dark", "#B3374B"],
            ["327", "Violet Dark", "#633970"],
            ["333", "Blue Violet Vy Dk", "#5C5478"],
            ["334", "Baby Blue Medium", "#739EC4"],
            ["335", "Rose", "#E95F7A"],
            ["336", "Navy Blue", "#253B6A"],
            ["340", "Blue Violet Med", "#AD9EC6"],
            ["341", "Blue Violet Light", "#B7B7D8"],
            ["347", "Salmon Very Dark", "#BF2D2D"],
            ["349", "Coral Dark", "#D22D35"],
            ["350", "Coral Medium", "#E04848"],
            ["351", "Coral", "#E96A67"],
            ["352", "Coral Light", "#FD9583"],
            ["353", "Peach", "#FEC5B4"],
            ["355", "Terra Cotta Dk", "#984937"],
            ["356", "Terra Cotta Med", "#C56B55"],
            ["367", "Pistachio Green Dk", "#61805A"],
            ["368", "Pistachio Green Lt", "#A6C89B"],
            ["369", "Pistachio Grn Vy Lt", "#D5ECC7"],
            ["370", "Mustard Medium", "#B88B4D"],
            ["371", "Mustard", "#BF9958"],
            ["372", "Mustard Light", "#CCA85F"],
            ["400", "Mahogany Dark", "#8C4931"],
            ["402", "Mahogany Vy Lt", "#F6A76A"],
            ["407", "Desert Sand Dk", "#B87D68"],
            ["413", "Pewter Gray Dark", "#5A5A5A"],
            ["414", "Steel Gray Dark", "#8C8C8C"],
            ["415", "Pearl Gray", "#D0D0D0"],
            ["420", "Hazelnut Brown Dk", "#A0713D"],
            ["422", "Hazelnut Brown Lt", "#C69C6D"],
            ["433", "Brown Medium", "#7A4A26"],
            ["434", "Brown Light", "#98642C"],
            ["435", "Brown Very Light", "#B8793E"],
            ["436", "Tan", "#CB9858"],
            ["437", "Tan Light", "#DDB97C"],
            ["444", "Lemon Dark", "#FFD600"],
            ["445", "Lemon Light", "#FFFFA0"],
            ["451", "Shell Gray Dark", "#908584"],
            ["452", "Shell Gray Med", "#B5A9A8"],
            ["453", "Shell Gray Lt", "#CBC2C0"],
            ["469", "Avocado Green", "#72843C"],
            ["470", "Avocado Green Lt", "#94A75A"],
            ["471", "Avocado Green Vy Lt", "#AEC27F"],
            ["472", "Avocado Grn Ult Lt", "#D6E9A6"],
            ["498", "Christmas Red Dk", "#A72025"],
            ["500", "Blue Green Vy Dk", "#044D45"],
            ["501", "Blue Green Dark", "#3B7368"],
            ["502", "Blue Green", "#5C9188"],
            ["503", "Blue Green Med", "#7BAD9F"],
            ["504", "Blue Green Vy Lt", "#C2D9CB"],
            ["505", "Jade Green", "#33826A"],
            ["517", "Wedgewood Dark", "#3B788F"],
            ["518", "Wedgewood Light", "#5FA0AF"],
            ["519", "Sky Blue", "#7FC0D5"],
            ["520", "Fern Green Dark", "#666B45"],
            ["522", "Fern Green", "#989F7A"],
            ["523", "Fern Green Light", "#ABB08E"],
            ["524", "Fern Green Vy Lt", "#C4C8AC"],
            ["535", "Ash Gray Vy Lt", "#636363"],
            ["543", "Beige Brown Ult Vy Lt", "#F3E6DA"],
            ["550", "Violet Very Dark", "#5C2C61"],
            ["552", "Violet Medium", "#803C8C"],
            ["553", "Violet", "#A356A4"],
            ["554", "Violet Light", "#D9A6DC"],
            ["561", "Jade Very Dark", "#2C6E5F"],
            ["562", "Jade Medium", "#538F7C"],
            ["563", "Jade Light", "#8FC5AB"],
            ["564", "Jade Very Light", "#C6E1CC"],
            ["580", "Moss Green Dark", "#888E36"],
            ["581", "Moss Green", "#A7AC4B"],
            ["597", "Turquoise", "#5BB4BF"],
            ["598", "Turquoise Light", "#90D5D6"],
            ["600", "Cranberry Vy Dk", "#CD2F62"],
            ["601", "Cranberry Dark", "#D1416E"],
            ["602", "Cranberry Med", "#E25884"],
            ["603", "Cranberry", "#FF7BA9"],
            ["604", "Cranberry Light", "#FF9FC2"],
            ["605", "Cranberry Vy Lt", "#FFBBD5"],
            ["606", "Bright Orange Red", "#FA400B"],
            ["608", "Bright Orange", "#FD6A02"],
            ["610", "Drab Brown Vy Dk", "#796248"],
            ["611", "Drab Brown Dark", "#967B5D"],
            ["612", "Drab Brown Med", "#BC9D7D"],
            ["613", "Drab Brown Light", "#D6C3AB"],
            ["632", "Desert Sand Ult Vy Dk", "#8E5642"],
            ["640", "Beige Gray Vy Dk", "#857F72"],
            ["642", "Beige Gray Dark", "#A39A8B"],
            ["644", "Beige Gray Med", "#DDD6CB"],
            ["645", "Beaver Gray Vy Dk", "#696969"],
            ["646", "Beaver Gray Dark", "#858585"],
            ["647", "Beaver Gray Med", "#9F9F9F"],
            ["648", "Beaver Gray Light", "#B8B8B8"],
            ["666", "Christmas Red Bright", "#E31D2E"],
            ["676", "Old Gold Light", "#E4C878"],
            ["677", "Old Gold Vy Lt", "#F5E6B0"],
            ["680", "Old Gold Dark", "#BC8A26"],
            ["699", "Christmas Green", "#056317"],
            ["700", "Christmas Green Bright", "#078C27"],
            ["701", "Christmas Green Lt", "#3F9F44"],
            ["702", "Kelly Green", "#47A747"],
            ["703", "Chartreuse", "#7EBF5F"],
            ["704", "Chartreuse Bright", "#9ECF43"],
            ["712", "Cream", "#FBF7E7"],
            ["718", "Plum", "#9C2D72"],
            ["720", "Orange Spice Dk", "#E55C20"],
            ["721", "Orange Spice Med", "#F27842"],
            ["722", "Orange Spice Lt", "#F7976D"],
            ["725", "Topaz", "#FFC840"],
            ["726", "Topaz Light", "#FEDA6B"],
            ["727", "Topaz Very Light", "#FFF1A8"],
            ["728", "Topaz Golden", "#E4B732"],
            ["729", "Old Gold Medium", "#D0A23A"],
            ["730", "Olive Green Vy Dk", "#827A28"],
            ["731", "Olive Green Dk", "#918531"],
            ["732", "Olive Green", "#9C8E38"],
            ["733", "Olive Green Med", "#BCA73C"],
            ["734", "Olive Green Lt", "#C7B561"],
            ["738", "Tan Very Light", "#ECCDAB"],
            ["739", "Tan Ultra Vy Lt", "#F5E3CD"],
            ["740", "Tangerine", "#FF8313"],
            ["741", "Tangerine Med", "#FFA041"],
            ["742", "Tangerine Light", "#FFBF6C"],
            ["743", "Yellow Medium", "#FED557"],
            ["744", "Yellow Pale", "#FFE793"],
            ["745", "Yellow Light Pale", "#FFF4BA"],
            ["746", "Off White", "#FCFAF1"],
            ["747", "Sky Blue Vy Lt", "#E5F5F8"],
            ["754", "Peach Light", "#F4C8B4"],
            ["758", "Terra Cotta Vy Lt", "#EEB59E"],
            ["760", "Salmon", "#F5A4A0"],
            ["761", "Salmon Light", "#FFC9C6"],
            ["762", "Pearl Gray Vy Lt", "#E8E8E8"],
            ["772", "Yellow Green Vy Lt", "#E1EFA7"],
            ["775", "Baby Blue Vy Lt", "#D0E8F7"],
            ["776", "Pink Medium", "#FCB5BC"],
            ["777", "Raspberry Vy Dk", "#912B51"],
            ["778", "Antique Mauve Vy Lt", "#DFB9BA"],
            ["779", "Cocoa Dark", "#6B4E3E"],
            ["780", "Topaz Ult Vy Dk", "#945B00"],
            ["781", "Topaz Very Dark", "#A76700"],
            ["782", "Topaz Dark", "#B97A12"],
            ["783", "Topaz Medium", "#CE9329"],
            ["791", "Cornflower Blue Vy Dk", "#464F79"],
            ["792", "Cornflower Blue Dk", "#555F8C"],
            ["793", "Cornflower Blue Med", "#707BA4"],
            ["794", "Cornflower Blue Lt", "#8F9BC6"],
            ["796", "Royal Blue Dark", "#1A3480"],
            ["797", "Royal Blue", "#1E4299"],
            ["798", "Delft Blue Dark", "#4672AC"],
            ["799", "Delft Blue Med", "#6B94C6"],
            ["800", "Delft Blue Pale", "#C0D6ED"],
            ["801", "Coffee Brown Dk", "#5D3417"],
            ["806", "Peacock Blue Dk", "#3D8B8B"],
            ["807", "Peacock Blue", "#64A8A4"],
            ["809", "Delft Blue", "#94B8D8"],
            ["813", "Blue Light", "#A1C4E3"],
            ["814", "Garnet Dark", "#7B2131"],
            ["815", "Garnet Medium", "#872C3A"],
            ["816", "Garnet", "#973843"],
            ["817", "Coral Red Vy Dk", "#BB2219"],
            ["818", "Baby Pink", "#FFDFD8"],
            ["819", "Baby Pink Light", "#FFE7E4"],
            ["820", "Royal Blue Vy Dk", "#0F2366"],
            ["822", "Beige Gray Light", "#E6DFD4"],
            ["823", "Navy Blue Dark", "#0E1C4B"],
            ["824", "Blue Very Dark", "#1F4680"],
            ["825", "Blue Dark", "#2D5B9A"],
            ["826", "Blue Medium", "#3D73B3"],
            ["827", "Blue Very Light", "#B4D3E8"],
            ["828", "Blue Ult Vy Lt", "#C6E3F1"],
            ["829", "Golden Olive Vy Dk", "#7E6008"],
            ["830", "Golden Olive Dk", "#8C6E11"],
            ["831", "Golden Olive Med", "#A4811F"],
            ["832", "Golden Olive", "#B28E22"],
            ["833", "Golden Olive Lt", "#C2A02F"],
            ["834", "Golden Olive Vy Lt", "#D4B54C"],
            ["838", "Beige Brown Vy Dk", "#5C4128"],
            ["839", "Beige Brown Dk", "#70503A"],
            ["840", "Beige Brown Med", "#9A7C5F"],
            ["841", "Beige Brown Lt", "#B99E82"],
            ["842", "Beige Brown Vy Lt", "#D4C4AF"],
            ["844", "Beaver Gray Ult Dk", "#525252"],
            ["868", "Hazelnut Brn Vy Dk", "#986C3C"],
            ["869", "Hazelnut Brown Dk", "#8F5F30"],
            ["890", "Pistachio Grn Ult Dk", "#174827"],
            ["891", "Carnation Dark", "#FF6271"],
            ["892", "Carnation Med", "#FF758A"],
            ["893", "Carnation Light", "#FC8DA5"],
            ["894", "Carnation Vy Lt", "#FFB4C1"],
            ["895", "Hunter Green Vy Dk", "#1B4125"],
            ["898", "Coffee Brown Vy Dk", "#492813"],
            ["899", "Rose Medium", "#F27688"],
            ["900", "Burnt Orange Dk", "#D65116"],
            ["902", "Garnet Very Dark", "#6A1C2B"],
            ["904", "Parrot Green Vy Dk", "#557A24"],
            ["905", "Parrot Green Dk", "#6A8E28"],
            ["906", "Parrot Green Med", "#82A62B"],
            ["907", "Parrot Green Lt", "#C3DF5B"],
            ["909", "Emerald Green Vy Dk", "#157A3A"],
            ["910", "Emerald Green Dk", "#188B46"],
            ["911", "Emerald Green Med", "#189A58"],
            ["912", "Emerald Green Lt", "#1BAA6B"],
            ["913", "Nile Green Med", "#6DC294"],
            ["915", "Plum Dark", "#820B49"],
            ["917", "Plum Medium", "#9B166B"],
            ["918", "Red Copper Dark", "#823024"],
            ["919", "Red Copper", "#A64B32"],
            ["920", "Copper Medium", "#AB5339"],
            ["921", "Copper", "#C66D42"],
            ["922", "Copper Light", "#E08155"],
            ["924", "Gray Green Vy Dk", "#566C67"],
            ["926", "Gray Green Med", "#98B1A8"],
            ["927", "Gray Green Light", "#BDD0C7"],
            ["928", "Gray Green Vy Lt", "#DDE8E4"],
            ["930", "Antique Blue Dk", "#455C7A"],
            ["931", "Antique Blue Med", "#6A839E"],
            ["932", "Antique Blue Lt", "#A2B6CA"],
            ["934", "Black Avocado Grn", "#3E4B2E"],
            ["935", "Avocado Green Dk", "#424C2F"],
            ["936", "Avocado Green Vy Dk", "#4C5532"],
            ["937", "Avocado Green Med", "#62733E"],
            ["938", "Coffee Brown Ult Dk", "#3D230E"],
            ["939", "Navy Blue Vy Dk", "#1B2C50"],
            ["943", "Aquamarine Med", "#3DB6A8"],
            ["945", "Tawny", "#FACCAB"],
            ["946", "Burnt Orange Med", "#EB6113"],
            ["947", "Burnt Orange", "#FF7B31"],
            ["948", "Peach Very Light", "#FEE9DD"],
            ["950", "Desert Sand Lt", "#EDD0BB"],
            ["951", "Tawny Light", "#FFE2CA"],
            ["954", "Nile Green", "#88C9A4"],
            ["955", "Nile Green Light", "#B1E1C2"],
            ["956", "Geranium", "#FF6D7D"],
            ["957", "Geranium Pale", "#FF9FAC"],
            ["958", "Sea Green Dark", "#3EB4A5"],
            ["959", "Sea Green Med", "#59CABB"],
            ["961", "Dusty Rose Dark", "#CF7A7E"],
            ["962", "Dusty Rose Med", "#E68F94"],
            ["963", "Dusty Rose Ult Vy Lt", "#FFDBD8"],
            ["964", "Sea Green Light", "#A9E5D9"],
            ["966", "Baby Green Med", "#B9DCC2"],
            ["967", "Apricot Very Lt", "#FFD3C3"],
            ["970", "Pumpkin Light", "#F78B14"],
            ["971", "Pumpkin", "#F67600"],
            ["972", "Canary Deep", "#FFB800"],
            ["973", "Canary Bright", "#FFE200"],
            ["975", "Golden Brown Dk", "#914F15"],
            ["976", "Golden Brown Med", "#C07728"],
            ["977", "Golden Brown Lt", "#DC9F4B"],
            ["986", "Forest Green Vy Dk", "#405226"],
            ["987", "Forest Green Dk", "#587238"],
            ["988", "Forest Green Med", "#739B4B"],
            ["989", "Forest Green", "#8BBB5D"],
            ["991", "Aquamarine Dk", "#478E86"],
            ["992", "Aquamarine Lt", "#6FC5B8"],
            ["993", "Aquamarine Vy Lt", "#90D5C9"],
            ["995", "Electric Blue Dk", "#266AAB"],
            ["996", "Electric Blue Med", "#3CADE8"],
            ["3011", "Khaki Green Dk", "#8A8C5B"],
            ["3012", "Khaki Green Med", "#A5A773"],
            ["3013", "Khaki Green Lt", "#B9BB8E"],
            ["3021", "Brown Gray Vy Dk", "#544A3F"],
            ["3022", "Brown Gray Med", "#8E8477"],
            ["3023", "Brown Gray Lt", "#B3AB9D"],
            ["3024", "Brown Gray Vy Lt", "#EBE8E3"],
            ["3031", "Mocha Brown Vy Dk", "#4B392A"],
            ["3032", "Mocha Brown Med", "#B09D84"],
            ["3033", "Mocha Brown Vy Lt", "#E3D6C6"],
            ["3041", "Antique Violet Med", "#9A7F97"],
            ["3042", "Antique Violet Lt", "#B8A3B5"],
            ["3045", "Yellow Beige Dk", "#BC955B"],
            ["3046", "Yellow Beige Med", "#D5B984"],
            ["3047", "Yellow Beige Lt", "#E7DBC0"],
            ["3051", "Green Gray Dark", "#5F6A4C"],
            ["3052", "Green Gray Med", "#889B6F"],
            ["3053", "Green Gray", "#9BAB85"],
            ["3064", "Desert Sand", "#C79C7D"],
            ["3072", "Beaver Gray Vy Lt", "#E0E0E0"],
            ["3078", "Golden Yellow Vy Lt", "#FFF6C2"],
            ["3325", "Baby Blue Light", "#B8D4E9"],
            ["3326", "Rose Light", "#FBB4B6"],
            ["3328", "Salmon Dark", "#E36D70"],
            ["3340", "Apricot Medium", "#FF8566"],
            ["3341", "Apricot", "#FC9D83"],
            ["3345", "Hunter Green Dk", "#1B5228"],
            ["3346", "Hunter Green", "#406F3E"],
            ["3347", "Yellow Green Med", "#71924C"],
            ["3348", "Yellow Green Lt", "#CCE09B"],
            ["3350", "Dusty Rose Ult Dk", "#BC4365"],
            ["3354", "Dusty Rose Lt", "#E5A3A1"],
            ["3362", "Pine Green Dark", "#5E6E49"],
            ["3363", "Pine Green Med", "#728959"],
            ["3364", "Pine Green", "#83986A"],
            ["3371", "Black Brown", "#1E110A"],
            ["3607", "Plum Light", "#C34A90"],
            ["3608", "Plum Very Light", "#EA97C5"],
            ["3609", "Plum Ultra Light", "#F4C7DD"],
            ["3685", "Mauve Very Dark", "#883A51"],
            ["3687", "Mauve", "#C76B80"],
            ["3688", "Mauve Medium", "#DC9BA7"],
            ["3689", "Mauve Light", "#FBC6CC"],
            ["3705", "Melon Dark", "#FF6A79"],
            ["3706", "Melon Medium", "#FF8A95"],
            ["3708", "Melon Light", "#FFCDD5"],
            ["3712", "Salmon Medium", "#F2847E"],
            ["3713", "Salmon Very Lt", "#FFE1DE"],
            ["3716", "Dusty Rose Med Vy Lt", "#FFBCBD"],
            ["3721", "Shell Pink Dk", "#A14F56"],
            ["3722", "Shell Pink Med", "#BC6465"],
            ["3726", "Antique Mauve Dk", "#9C5B62"],
            ["3727", "Antique Mauve Lt", "#DBA9A9"],
            ["3731", "Dusty Rose Vy Dk", "#C8647C"],
            ["3733", "Dusty Rose", "#E89396"],
            ["3740", "Antique Violet Dk", "#786171"],
            ["3743", "Antique Violet Vy Lt", "#D7CAD6"],
            ["3746", "Blue Violet Dk", "#776E9F"],
            ["3747", "Blue Violet Vy Lt", "#D6D6EB"],
            ["3750", "Antique Blue Vy Dk", "#384C60"],
            ["3752", "Antique Blue Vy Lt", "#C4D2DF"],
            ["3753", "Antique Blue Ult Vy Lt", "#DBE6EE"],
            ["3755", "Baby Blue", "#939FC9"],
            ["3756", "Baby Blue Ult Vy Lt", "#EEFBFF"],
            ["3760", "Wedgewood Med", "#3E8FAA"],
            ["3761", "Sky Blue Light", "#ACD8E5"],
            ["3765", "Peacock Blue Vy Dk", "#348282"],
            ["3766", "Peacock Blue Lt", "#99D3CF"],
            ["3768", "Gray Green Dk", "#657E78"],
            ["3770", "Tawny Very Lt", "#FFECDB"],
            ["3771", "Terra Cotta Ult Vy Lt", "#F4C4A9"],
            ["3772", "Desert Sand Vy Dk", "#A0715C"],
            ["3773", "Desert Sand Med", "#D9A58C"],
            ["3774", "Desert Sand Vy Lt", "#F5E3D8"],
            ["3776", "Mahogany Light", "#CF7339"],
            ["3777", "Terra Cotta Vy Dk", "#863123"],
            ["3778", "Terra Cotta Lt", "#D99175"],
            ["3779", "Terra Cotta Ult Vy Lt", "#F8CDB9"],
            ["3781", "Mocha Brown Dk", "#6B4F3D"],
            ["3782", "Mocha Brown Lt", "#D0BDA5"],
            ["3787", "Brown Gray Dk", "#6E635A"],
            ["3790", "Beige Gray Ult Dk", "#6E5E52"],
            ["3799", "Pewter Gray Vy Dk", "#474747"],
            ["3801", "Melon Very Dk", "#E7455F"],
            ["3802", "Antique Mauve Vy Dk", "#6E3841"],
            ["3803", "Mauve Dark", "#8E2F52"],
            ["3804", "Cyclamen Pink Dk", "#D23179"],
            ["3805", "Cyclamen Pink", "#F33E93"],
            ["3806", "Cyclamen Pink Lt", "#FF7ABE"],
            ["3807", "Cornflower Blue", "#607AAC"],
            ["3808", "Turquoise Ult Vy Dk", "#366A69"],
            ["3809", "Turquoise Vy Dk", "#3F807A"],
            ["3810", "Turquoise Dark", "#489B96"],
            ["3811", "Turquoise Vy Lt", "#BCE3E1"],
            ["3812", "Sea Green Vy Dk", "#2F9D8F"],
            ["3813", "Blue Green Lt", "#B8D6C8"],
            ["3814", "Aquamarine", "#509289"],
            ["3815", "Celadon Green Dk", "#478061"],
            ["3816", "Celadon Green", "#659878"],
            ["3817", "Celadon Green Lt", "#99BFA3"],
            ["3818", "Emerald Grn Ult Vy Dk", "#116531"],
            ["3819", "Moss Green Lt", "#E0EC91"],
            ["3820", "Straw Dark", "#DFB342"],
            ["3821", "Straw", "#F3C95C"],
            ["3822", "Straw Light", "#F6DC8F"],
            ["3823", "Yellow Ultra Pale", "#FFFDD5"],
            ["3824", "Apricot Light", "#FEC5AB"],
            ["3825", "Pumpkin Pale", "#FDB173"],
            ["3826", "Golden Brown", "#AD6E2C"],
            ["3827", "Golden Brown Pale", "#F7BA70"],
            ["3828", "Hazelnut Brown", "#B5864E"],
            ["3829", "Old Gold Vy Dk", "#AA7B10"],
            ["3830", "Terra Cotta", "#BC6545"],
            ["3831", "Raspberry Dk", "#B42E56"],
            ["3832", "Raspberry Med", "#DB516F"],
            ["3833", "Raspberry Lt", "#EA8895"],
            ["3834", "Grape Dark", "#723963"],
            ["3835", "Grape Medium", "#945F8C"],
            ["3836", "Grape Light", "#BA94B1"],
            ["3837", "Lavender Ult Dk", "#6C3A78"],
            ["3838", "Lavender Blue Dk", "#5C6DA4"],
            ["3839", "Lavender Blue Med", "#7B8DBE"],
            ["3840", "Lavender Blue Lt", "#B1BEE0"],
            ["3841", "Baby Blue Pale", "#CDDDEE"],
            ["3842", "Wedgewood Vy Dk", "#2B6078"],
            ["3843", "Electric Blue", "#17B6DC"],
            ["3844", "Turquoise Bright Dk", "#12A2AE"],
            ["3845", "Turquoise Bright Med", "#4AC4CB"],
            ["3846", "Turquoise Bright Lt", "#95E7E8"],
            ["3847", "Teal Green Dk", "#347975"],
            ["3848", "Teal Green Med", "#559490"],
            ["3849", "Teal Green Lt", "#52B3A3"],
            ["3850", "Bright Green Dk", "#388C6C"],
            ["3851", "Bright Green Lt", "#49B896"],
            ["3852", "Straw Very Dk", "#CD9C25"],
            ["3853", "Autumn Gold Dk", "#F29341"],
            ["3854", "Autumn Gold Med", "#F2AB66"],
            ["3855", "Autumn Gold Lt", "#FAD197"],
            ["3856", "Mahogany Ult Vy Lt", "#FFD3AF"],
            ["3857", "Rosewood Dk", "#6C3731"],
            ["3858", "Rosewood Med", "#964942"],
            ["3859", "Rosewood Lt", "#BA8178"],
            ["3860", "Cocoa", "#8E6B60"],
            ["3861", "Cocoa Light", "#AC9087"],
            ["3862", "Mocha Beige Dk", "#8A6C4F"],
            ["3863", "Mocha Beige Med", "#AB9175"],
            ["3864", "Mocha Beige Lt", "#CBB99E"],
            ["3865", "Winter White", "#F8F8F5"],
            ["3866", "Mocha Brown Ult Vy Lt", "#FAF5EF"]
        ];

        // State
        let myCollection = new Map();
        let currentFilter = 'all';
        let searchQuery = '';
        let neededList = [];
        let ownedList = [];

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            loadCollection();
            renderThreads();
            updateStats();
            setupListeners();
        });

        function loadCollection() {
            const saved = localStorage.getItem('dmc_collection');
            if (saved) {
                try {
                    myCollection = new Map(Object.entries(JSON.parse(saved)));
                } catch(e) {}
            }
        }

        function saveCollection() {
            localStorage.setItem('dmc_collection', JSON.stringify(Object.fromEntries(myCollection)));
        }

        function setupListeners() {
            document.getElementById('searchInput').addEventListener('input', e => {
                searchQuery = e.target.value.toLowerCase();
                renderThreads();
            });

            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentFilter = btn.dataset.filter;
                    renderThreads();
                });
            });

            document.querySelectorAll('.panel-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.panel-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    tab.classList.add('active');
                    document.getElementById(tab.dataset.tab + 'Tab').classList.add('active');
                });
            });

            document.getElementById('patternInput').addEventListener('input', checkPattern);
            document.getElementById('colorSearchInput').addEventListener('input', findSimilar);
        }

        function getThreadByNumber(num) {
            const normalized = num.toUpperCase().replace(/^0+/, '');
            return DMC_THREADS.find(t => 
                t[0] === num || t[0] === normalized || t[0].replace(/^0+/, '') === normalized
            );
        }

        function renderThreads() {
            const grid = document.getElementById('threadGrid');
            
            const filtered = DMC_THREADS.filter(t => {
                const match = t[0].toLowerCase().includes(searchQuery) || t[1].toLowerCase().includes(searchQuery);
                if (!match) return false;
                if (currentFilter === 'owned') return myCollection.has(t[0]);
                if (currentFilter === 'needed') return !myCollection.has(t[0]);
                return true;
            });

            grid.innerHTML = filtered.map(t => {
                const owned = myCollection.has(t[0]);
                const qty = myCollection.get(t[0]) || 0;

                return `
                    <div class="thread-item ${owned ? 'checked' : ''}" onclick="toggleThread('${t[0]}', event)">
                        <div class="thread-checkbox">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                        </div>
                        <div class="color-swatch" style="background-color: ${t[2]}"></div>
                        <span class="thread-number">${t[0]}</span>
                        <span class="thread-name">${t[1]}</span>
                        <div class="qty-controls" onclick="event.stopPropagation()">
                            <button class="qty-btn" onclick="changeQty('${t[0]}', -1)">‚àí</button>
                            <span class="qty-badge">${qty}</span>
                            <button class="qty-btn" onclick="changeQty('${t[0]}', 1)">+</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function toggleThread(num, event) {
            if (event.target.closest('.qty-controls')) return;
            
            if (myCollection.has(num)) {
                myCollection.delete(num);
            } else {
                myCollection.set(num, 1);
            }
            
            saveCollection();
            updateStats();
            renderThreads();
            checkPattern();
        }

        function changeQty(num, delta) {
            const current = myCollection.get(num) || 0;
            const newQty = Math.max(0, current + delta);
            
            if (newQty === 0) {
                myCollection.delete(num);
            } else {
                myCollection.set(num, newQty);
            }
            
            saveCollection();
            updateStats();
            renderThreads();
            checkPattern();
        }

        function updateStats() {
            document.getElementById('ownedCount').textContent = myCollection.size;
            const total = Array.from(myCollection.values()).reduce((a, b) => a + b, 0);
            document.getElementById('skeinCount').textContent = total;
        }

        function checkPattern() {
            const input = document.getElementById('patternInput').value;
            const area = document.getElementById('resultsArea');

            if (!input.trim()) {
                area.innerHTML = '<div class="empty-state">Enter thread numbers to see<br>what you have vs. need to buy</div>';
                neededList = [];
                ownedList = [];
                return;
            }

            const nums = [...new Set(
                input.toUpperCase().split(/[\s,;]+/).map(n => n.trim()).filter(n => n)
            )];

            ownedList = [];
            neededList = [];

            nums.forEach(n => {
                const thread = getThreadByNumber(n);
                if (thread) {
                    if (myCollection.has(thread[0])) {
                        ownedList.push(thread);
                    } else {
                        neededList.push(thread);
                    }
                }
            });

            let html = '';
            
            // Always show "Need to Buy" first if there are items
            if (neededList.length) {
                html += `<div class="result-group">
                    <div class="result-title"><span class="dot orange"></span> Need to Buy (${neededList.length})</div>
                    <div class="thread-list">
                        ${neededList.map(t => `
                            <div class="thread-row needed">
                                <span class="mini-swatch" style="background: ${t[2]}"></span>
                                <span class="number">${t[0]}</span>
                                <span class="name">${t[1]}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>`;
            }
            
            // Then show "You Have"
            if (ownedList.length) {
                html += `<div class="result-group">
                    <div class="result-title"><span class="dot green"></span> You Have (${ownedList.length})</div>
                    <div class="thread-list">
                        ${ownedList.map(t => `
                            <div class="thread-row owned">
                                <span class="mini-swatch" style="background: ${t[2]}"></span>
                                <span class="number">${t[0]}</span>
                                <span class="name">${t[1]}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>`;
            }
            
            area.innerHTML = html || '<div class="empty-state">No valid DMC numbers found</div>';
        }

        // Color distance calculation
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        }

        function colorDistance(hex1, hex2) {
            const c1 = hexToRgb(hex1);
            const c2 = hexToRgb(hex2);
            if (!c1 || !c2) return Infinity;
            return Math.sqrt(
                Math.pow(c1.r - c2.r, 2) +
                Math.pow(c1.g - c2.g, 2) +
                Math.pow(c1.b - c2.b, 2)
            );
        }

        function findSimilarColors(threadNum, count = 6) {
            const thread = getThreadByNumber(threadNum);
            if (!thread) return [];
            
            const targetHex = thread[2];
            
            return DMC_THREADS
                .filter(t => t[0] !== thread[0])
                .map(t => ({
                    thread: t,
                    distance: colorDistance(targetHex, t[2])
                }))
                .sort((a, b) => a.distance - b.distance)
                .slice(0, count)
                .map(item => item.thread);
        }

        function findSimilar() {
            const input = document.getElementById('colorSearchInput').value.trim();
            const area = document.getElementById('similarResults');

            if (!input) {
                area.innerHTML = '<div class="empty-state">Ran out of a thread?<br>Find the closest alternatives!</div>';
                return;
            }

            const thread = getThreadByNumber(input);
            if (!thread) {
                area.innerHTML = '<div class="empty-state">Thread not found.<br>Try a valid DMC number.</div>';
                return;
            }

            const similar = findSimilarColors(input, 6);
            const isOwned = myCollection.has(thread[0]);

            let html = `
                <div class="similar-result">
                    <div class="similar-header">
                        <div class="swatch" style="background: ${thread[2]}"></div>
                        <div class="info">
                            <div class="number">${thread[0]}</div>
                            <div class="name">${thread[1]}</div>
                        </div>
                        <span class="status ${isOwned ? 'owned' : 'not-owned'}">${isOwned ? '‚úì Owned' : 'Not owned'}</span>
                    </div>
                    <div class="similar-list-title">Closest alternatives:</div>
                    <div class="similar-tags">
                        ${similar.map(t => {
                            const owned = myCollection.has(t[0]);
                            return `<span class="similar-tag ${owned ? 'has-it' : ''}" onclick="document.getElementById('colorSearchInput').value='${t[0]}';findSimilar();">
                                <span class="mini-swatch" style="background:${t[2]}"></span>
                                ${t[0]}${owned ? ' ‚úì' : ''}
                            </span>`;
                        }).join('')}
                    </div>
                </div>
            `;

            // Show which similar colors user owns
            const ownedAlternatives = similar.filter(t => myCollection.has(t[0]));
            if (ownedAlternatives.length > 0 && !isOwned) {
                html += `
                    <div class="result-group" style="margin-top: 0.75rem;">
                        <div class="result-title"><span class="dot green"></span> You own these alternatives:</div>
                        <div class="thread-list">
                            ${ownedAlternatives.map(t => `
                                <div class="thread-row owned">
                                    <span class="mini-swatch" style="background:${t[2]}"></span>
                                    <span class="number">${t[0]}</span>
                                    <span class="name">${t[1]}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            area.innerHTML = html;
        }

        function copyList() {
            if (!neededList.length && !ownedList.length) return showToast('Enter pattern threads first');
            
            let text = 'DMC Shopping List\n';
            text += '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n';
            
            if (neededList.length) {
                text += 'üõí NEED TO BUY:\n';
                neededList.forEach(t => {
                    text += `  ${t[0]} - ${t[1]}\n`;
                });
                text += '\n';
            }
            
            if (ownedList.length) {
                text += '‚úì ALREADY HAVE:\n';
                ownedList.forEach(t => {
                    text += `  ${t[0]} - ${t[1]}\n`;
                });
            }
            
            text += '\n‚Äî Needle Treasures Nook';
            
            navigator.clipboard.writeText(text).then(() => showToast('List copied!'));
        }

        // Print Modal Functions
        function openPrintModal() {
            if (!neededList.length && !ownedList.length) {
                return showToast('Enter pattern threads first');
            }

            const modal = document.getElementById('printModal');
            const body = document.getElementById('printBody');
            const dateEl = document.getElementById('printDate');
            
            dateEl.textContent = new Date().toLocaleDateString('en-US', { 
                year: 'numeric', month: 'long', day: 'numeric' 
            });

            let html = '';

            if (neededList.length) {
                html += `
                    <div class="print-section">
                        <div class="print-section-title needed">
                            üõí Need to Buy (${neededList.length})
                        </div>
                        ${neededList.map(t => `
                            <div class="print-thread">
                                <div class="swatch" style="background: ${t[2]}"></div>
                                <span class="number">${t[0]}</span>
                                <span class="name">${t[1]}</span>
                                <span class="qty-label">Qty:</span>
                                <input type="text" class="qty-input" value="1">
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            if (ownedList.length) {
                html += `
                    <div class="print-section">
                        <div class="print-section-title owned">
                            ‚úì Already Have (${ownedList.length})
                        </div>
                        ${ownedList.map(t => `
                            <div class="print-thread">
                                <div class="swatch" style="background: ${t[2]}"></div>
                                <span class="number">${t[0]}</span>
                                <span class="name">${t[1]}</span>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            body.innerHTML = html;
            modal.classList.add('show');
        }

        function closePrintModal() {
            document.getElementById('printModal').classList.remove('show');
        }

        function doPrint() {
            const printContent = document.getElementById('printBody').innerHTML;
            const printDate = document.getElementById('printDate').textContent;
            
            const printWindow = document.createElement('iframe');
            printWindow.style.position = 'absolute';
            printWindow.style.top = '-10000px';
            printWindow.style.left = '-10000px';
            document.body.appendChild(printWindow);

            const doc = printWindow.contentDocument || printWindow.contentWindow.document;
            doc.open();
            doc.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Shopping List - Needle Treasures Nook</title>
                    <style>
                        body {
                            font-family: 'Segoe UI', Arial, sans-serif;
                            padding: 20px;
                            color: #333;
                            max-width: 800px;
                            margin: 0 auto;
                        }
                        .header {
                            background: linear-gradient(135deg, #C67B5C 0%, #A85D40 100%);
                            color: white;
                            padding: 15px 20px;
                            border-radius: 8px;
                            margin-bottom: 20px;
                        }
                        .header h1 {
                            margin: 0;
                            font-size: 20px;
                        }
                        .header .date {
                            font-size: 12px;
                            opacity: 0.9;
                            margin-top: 3px;
                        }
                        .print-section {
                            margin-bottom: 25px;
                        }
                        .print-section-title {
                            font-size: 14px;
                            font-weight: bold;
                            margin-bottom: 10px;
                            padding-bottom: 8px;
                            border-bottom: 2px solid #EDE6DA;
                        }
                        .print-section-title.needed { color: #C67B5C; }
                        .print-section-title.owned { color: #6F8066; }
                        .print-thread {
                            display: flex;
                            align-items: center;
                            gap: 10px;
                            padding: 8px 0;
                            border-bottom: 1px solid #F5F0E8;
                        }
                        .swatch {
                            width: 20px;
                            height: 20px;
                            border-radius: 3px;
                            border: 1px solid rgba(0,0,0,0.15);
                            -webkit-print-color-adjust: exact;
                            print-color-adjust: exact;
                        }
                        .number {
                            font-weight: bold;
                            min-width: 50px;
                        }
                        .name {
                            flex: 1;
                            color: #666;
                        }
                        .qty-label {
                            font-size: 12px;
                            color: #888;
                        }
                        .qty-input {
                            width: 40px;
                            height: 24px;
                            border: 1px solid #ccc;
                            border-radius: 3px;
                            text-align: center;
                        }
                        .footer {
                            margin-top: 20px;
                            padding-top: 15px;
                            border-top: 1px solid #EDE6DA;
                            text-align: center;
                            color: #7A6B5E;
                            font-size: 11px;
                        }
                        .footer a { 
                            color: #C67B5C; 
                            font-weight: 600;
                            text-decoration: none;
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>üßµ Shopping List</h1>
                        <div class="date">${printDate}</div>
                    </div>
                    ${printContent}
                    <div class="footer">
                        Created with DMC Inventory Tool by<br>
                        <a href="https://needletreasuresnook.etsy.com">Needle Treasures Nook</a>
                    </div>
                </body>
                </html>
            `);
            doc.close();

            printWindow.contentWindow.focus();
            setTimeout(() => {
                printWindow.contentWindow.print();
                setTimeout(() => {
                    document.body.removeChild(printWindow);
                }, 1000);
            }, 250);

            closePrintModal();
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.textContent = msg;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 2000);
        }

        // Close modal on outside click
        document.getElementById('printModal').addEventListener('click', function(e) {
            if (e.target === this) closePrintModal();
        });
    </script>

    <!-- MailerLite Universal -->
    <script src="https://groot.mailerlite.com/js/w/webforms.min.js?v176e10baa5e7ed80d35ae235be3d5024" type="text/javascript"></script>
    <script>
        fetch("https://assets.mailerlite.com/jsonp/2010016/forms/175294884076324104/takel");
    </script>

    <!-- PWA Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('SW registered'))
                    .catch(err => console.log('SW failed:', err));
            });
        }

        // PWA Install
        let deferredPrompt;
        const installBtn = document.getElementById('installBtn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
        });

        installBtn.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null;
            } else {
                // Show instructions modal
                document.getElementById('installModal').style.display = 'flex';
            }
        });

        function closeInstallModal() {
            document.getElementById('installModal').style.display = 'none';
        }

        window.addEventListener('appinstalled', () => {
            console.log('App installed');
        });
    </script>
</body>
</html>
